{".class":"MypyFile","_fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper","future_import_flags":[],"is_partial_stub_package":false,"is_stub":false,"names":{".class":"SymbolTable","FusedCommBuffer":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["builtins.object"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer","name":"FusedCommBuffer","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"paddle.distributed.fleet.utils.tensor_fusion_helper","mro":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,1,1,1,1,1,1,1,1,1],"arg_names":["self","id","params","comm_group","acc_steps","act","dst","use_main_grad","fuse_param","scale_after_comm","release_grads","use_reduce_avg","free_grads_in_comm"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.__init__","name":"__init__","type":null}},"_acc_steps":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._acc_steps","name":"_acc_steps","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_act":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._act","name":"_act","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_all_params_checked_in":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_property","is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._all_params_checked_in","name":"_all_params_checked_in","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_property","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._all_params_checked_in","name":"_all_params_checked_in","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":true,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_all_params_checked_in of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"_clear_grad_storage":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._clear_grad_storage","name":"_clear_grad_storage","type":null}},"_comm_grads":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._comm_grads","name":"_comm_grads","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._comm_grads","name":"_comm_grads","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer"],"bound_args":[],"def_extras":{},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"_comm_grads of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"_comm_group":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._comm_group","name":"_comm_group","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_copy_grad_to_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","param"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._copy_grad_to_buffer","name":"_copy_grad_to_buffer","type":null}},"_dst":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._dst","name":"_dst","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_dtype":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._dtype","name":"_dtype","type":{".class":"UnionType","items":["paddle.framework.dtype.dtype",{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}],"uses_pep604_syntax":false}}},"_free_grads_in_comm":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._free_grads_in_comm","name":"_free_grads_in_comm","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_fuse_param":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._fuse_param","name":"_fuse_param","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_grads_to_addr":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred","invalid_partial_type"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._grads_to_addr","name":"_grads_to_addr","type":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"_id":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._id","name":"_id","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_init_step_dict":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._init_step_dict","name":"_init_step_dict","type":null}},"_params":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._params","name":"_params","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_params_checked_in":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._params_checked_in","name":"_params_checked_in","type":"builtins.int"}},"_params_step_dict":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred","invalid_partial_type"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._params_step_dict","name":"_params_step_dict","type":{".class":"Instance","args":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"_record_addr":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._record_addr","name":"_record_addr","type":null}},"_release_grads":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._release_grads","name":"_release_grads","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_reset_grad_storage":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","slice_grad_buffer"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._reset_grad_storage","name":"_reset_grad_storage","type":null}},"_reset_params_checked_in":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._reset_params_checked_in","name":"_reset_params_checked_in","type":null}},"_scale_after_comm":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._scale_after_comm","name":"_scale_after_comm","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_sharding_param_grad_view":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._sharding_param_grad_view","name":"_sharding_param_grad_view","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"_task":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred","invalid_partial_type"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._task","name":"_task","type":{".class":"UnionType","items":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"NoneType"}],"uses_pep604_syntax":false}}},"_use_reduce_avg":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer._use_reduce_avg","name":"_use_reduce_avg","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"add_grad":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,1],"arg_names":["self","param","use_comm"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.add_grad","name":"add_grad","type":null}},"assign_slice_grad":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0],"arg_names":["self","param","slice_param"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.assign_slice_grad","name":"assign_slice_grad","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.assign_slice_grad","name":"assign_slice_grad","type":{".class":"CallableType","arg_kinds":[0,0,0],"arg_names":["self","param","slice_param"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"assign_slice_grad of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"buffer_size":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.buffer_size","name":"buffer_size","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"comm_grads":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.comm_grads","name":"comm_grads","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.comm_grads","name":"comm_grads","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer"],"bound_args":[],"def_extras":{},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"comm_grads of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"grad_storage":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.grad_storage","name":"grad_storage","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"param2offset":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.param2offset","name":"param2offset","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"param_storage":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.param_storage","name":"param_storage","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"params":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_property","is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.params","name":"params","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_property","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.params","name":"params","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer"],"bound_args":[],"def_extras":{"first_arg":"self"},"fallback":"builtins.function","from_concatenate":false,"implicit":true,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"params of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"scale_grads":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.scale_grads","name":"scale_grads","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.scale_grads","name":"scale_grads","type":{".class":"CallableType","arg_kinds":[0],"arg_names":["self"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer"],"bound_args":[],"def_extras":{},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"scale_grads of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"sync_params":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Decorator","func":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1],"arg_names":["self","sync","param2task"],"dataclass_transform_spec":null,"deprecated":null,"flags":["is_decorated"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.sync_params","name":"sync_params","type":null},"is_overload":false,"var":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.sync_params","name":"sync_params","type":{".class":"CallableType","arg_kinds":[0,1,1],"arg_names":["self","sync","param2task"],"arg_types":["paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}],"bound_args":[],"def_extras":{},"fallback":"builtins.function","from_concatenate":false,"implicit":false,"imprecise_arg_kinds":false,"is_ellipsis_args":false,"name":"sync_params of FusedCommBuffer","ret_type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7},"type_guard":null,"type_is":null,"unpack_kwargs":false,"variables":[]}}}},"use_main_grad":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.use_main_grad","name":"use_main_grad","type":{".class":"UnionType","items":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"builtins.bool"],"uses_pep604_syntax":false}}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer.Self","id":0,"name":"Self","namespace":"","upper_bound":"paddle.distributed.fleet.utils.tensor_fusion_helper.FusedCommBuffer","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"HOOK_ACTION":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["builtins.object"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION","name":"HOOK_ACTION","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"paddle.distributed.fleet.utils.tensor_fusion_helper","mro":["paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION","builtins.object"],"names":{".class":"SymbolTable","ALL_REDUCE":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION.ALL_REDUCE","name":"ALL_REDUCE","type":"builtins.int"}},"REDUCE":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION.REDUCE","name":"REDUCE","type":"builtins.int"}},"REDUCE_SCATTER":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"Var","flags":["is_initialized_in_class","is_ready","is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION.REDUCE_SCATTER","name":"REDUCE_SCATTER","type":"builtins.int"}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION.Self","id":0,"name":"Self","namespace":"","upper_bound":"paddle.distributed.fleet.utils.tensor_fusion_helper.HOOK_ACTION","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"OrderedDict":{".class":"SymbolTableNode","cross_ref":"collections.OrderedDict","kind":"Gdef","module_hidden":true,"module_public":false},"ShardingGradView":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"TypeInfo","_promote":[],"abstract_attributes":[],"alt_promote":null,"bases":["builtins.object"],"dataclass_transform_spec":null,"declared_metaclass":null,"defn":{".class":"ClassDef","fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView","name":"ShardingGradView","type_vars":[]},"deletable_attributes":[],"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView","has_param_spec_type":false,"metaclass_type":null,"metadata":{},"module_name":"paddle.distributed.fleet.utils.tensor_fusion_helper","mro":["paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView","builtins.object"],"names":{".class":"SymbolTable","__init__":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0,0,0,0,0,1,1],"arg_names":["self","param","param_buffer","grad_buffer","index","padded_size","sharding_degree","rank","use_main_grad","release_grad"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView.__init__","name":"__init__","type":null}},"_clear_grad_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._clear_grad_buffer","name":"_clear_grad_buffer","type":null}},"_get_padding":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._get_padding","name":"_get_padding","type":null}},"_grad_buffer":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._grad_buffer","name":"_grad_buffer","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_index":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._index","name":"_index","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_link_grad_to_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._link_grad_to_buffer","name":"_link_grad_to_buffer","type":null}},"_padded_size":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._padded_size","name":"_padded_size","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_param":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._param","name":"_param","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_param_begin":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._param_begin","name":"_param_begin","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"_param_buffer":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._param_buffer","name":"_param_buffer","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_param_end":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._param_end","name":"_param_end","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"_rank":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._rank","name":"_rank","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_rank_begin":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._rank_begin","name":"_rank_begin","type":{".class":"AnyType","missing_import_name":null,"source_any":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},"type_of_any":7}}},"_release_grad":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._release_grad","name":"_release_grad","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_reset_grad_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","slice_grad_buffer"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._reset_grad_buffer","name":"_reset_grad_buffer","type":null}},"_sharding_degree":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._sharding_degree","name":"_sharding_degree","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"_share_param_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._share_param_buffer","name":"_share_param_buffer","type":null}},"_slice_grad":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred","invalid_partial_type"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._slice_grad","name":"_slice_grad","type":{".class":"UnionType","items":[{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1},{".class":"NoneType"}],"uses_pep604_syntax":false}}},"_slice_grad_from_buffer":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0],"arg_names":["self"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._slice_grad_from_buffer","name":"_slice_grad_from_buffer","type":null}},"_use_main_grad":{".class":"SymbolTableNode","implicit":true,"kind":"Mdef","node":{".class":"Var","flags":["is_inferred"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView._use_main_grad","name":"_use_main_grad","type":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":1}}},"assign_slice_grad":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","slice_param"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView.assign_slice_grad","name":"assign_slice_grad","type":null}},"fill_slice_param":{".class":"SymbolTableNode","kind":"Mdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["self","slice_param"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView.fill_slice_param","name":"fill_slice_param","type":null}}},"self_type":{".class":"TypeVarType","default":{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":4},"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView.Self","id":0,"name":"Self","namespace":"","upper_bound":"paddle.distributed.fleet.utils.tensor_fusion_helper.ShardingGradView","values":[],"variance":0},"slots":null,"tuple_type":null,"type_vars":[],"typeddict_type":null}},"__annotations__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__annotations__","name":"__annotations__","type":{".class":"Instance","args":["builtins.str",{".class":"AnyType","missing_import_name":null,"source_any":null,"type_of_any":6}],"extra_attrs":null,"type_ref":"builtins.dict"}}},"__current_device_type__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__current_device_type__","name":"__current_device_type__","type":{".class":"NoneType"}}},"__doc__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__doc__","name":"__doc__","type":"builtins.str"}},"__file__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__file__","name":"__file__","type":"builtins.str"}},"__name__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__name__","name":"__name__","type":"builtins.str"}},"__package__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__package__","name":"__package__","type":"builtins.str"}},"__spec__":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_ready"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.__spec__","name":"__spec__","type":"_frozen_importlib.ModuleSpec"}},"_current_expected_place_":{".class":"SymbolTableNode","cross_ref":"paddle.base.framework._current_expected_place_","kind":"Gdef","module_hidden":true,"module_public":false},"_fused_parameters_impl":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1,1,1,1,1,1,1,1,1,1],"arg_names":["parameters","use_main_grad","fuse_param","comm_overlap","comm_group","act","dst","acc_step","scale_after_comm","apply_decay_param_fun","use_reduce_avg","group_size"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper._fused_parameters_impl","name":"_fused_parameters_impl","type":null}},"align":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.align","name":"align","type":{".class":"Instance","args":["paddle.framework.dtype.dtype","builtins.int"],"extra_attrs":null,"type_ref":"builtins.dict"}}},"alignment":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"Var","flags":["is_inferred","has_explicit_value"],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.alignment","name":"alignment","type":{".class":"Instance","args":["builtins.str","builtins.int"],"extra_attrs":null,"type_ref":"builtins.dict"}}},"assign_group_by_size":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1],"arg_names":["parameters","group_size"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.assign_group_by_size","name":"assign_group_by_size","type":null}},"build_reduce_scatter_buffer":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,1,1],"arg_names":["parameters","sharding_degree","rank","use_main_grad","release_grad"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.build_reduce_scatter_buffer","name":"build_reduce_scatter_buffer","type":null}},"bw_hook_func":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["buffer","param"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.bw_hook_func","name":"bw_hook_func","type":null}},"check_naninf":{".class":"SymbolTableNode","cross_ref":"paddle.framework.recall_error.check_naninf","kind":"Gdef","module_hidden":true,"module_public":false},"core":{".class":"SymbolTableNode","cross_ref":"paddle.base.core","kind":"Gdef","module_hidden":true,"module_public":false},"filter_params":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0,0,0],"arg_names":["params","is_fp32","is_distributed","need_clip"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.filter_params","name":"filter_params","type":null}},"flatten_dense_tensors":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1,1,1],"arg_names":["parameters","use_main_grad","fuse_param","warp_buffer","release_grad"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.flatten_dense_tensors","name":"flatten_dense_tensors","type":null}},"fused_parameters":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1,1,1,1,1,1,1,1,1,1,1],"arg_names":["parameters","use_main_grad","fuse_param","comm_overlap","comm_group","act","dst","acc_step","scale_after_comm","group_params","apply_decay_param_fun","use_reduce_avg","group_size"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.fused_parameters","name":"fused_parameters","type":null}},"get_current_device_type":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[],"arg_names":[],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.get_current_device_type","name":"get_current_device_type","type":null}},"get_grad_address":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,0],"arg_names":["param","use_main_grad"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.get_grad_address","name":"get_grad_address","type":null}},"imperative_base":{".class":"SymbolTableNode","cross_ref":"paddle.base.dygraph.base","kind":"Gdef","module_hidden":true,"module_public":false},"itertools":{".class":"SymbolTableNode","cross_ref":"itertools","kind":"Gdef","module_hidden":true,"module_public":false},"logger":{".class":"SymbolTableNode","cross_ref":"paddle.distributed.fleet.utils.log_util.logger","kind":"Gdef","module_hidden":true,"module_public":false},"np":{".class":"SymbolTableNode","cross_ref":"numpy","kind":"Gdef","module_hidden":true,"module_public":false},"obtain_storage":{".class":"SymbolTableNode","kind":"Gdef","node":{".class":"FuncDef","abstract_status":0,"arg_kinds":[0,1,1,1,1,1,1,1,1,1,1,1,1],"arg_names":["parameters","use_main_grad","clip","dist","fuse_param","comm_overlap","act","comm_group","dst","acc_steps","scale_after_comm","use_reduce_avg","group_size"],"dataclass_transform_spec":null,"deprecated":null,"flags":[],"fullname":"paddle.distributed.fleet.utils.tensor_fusion_helper.obtain_storage","name":"obtain_storage","type":null}},"os":{".class":"SymbolTableNode","cross_ref":"os","kind":"Gdef","module_hidden":true,"module_public":false},"paddle":{".class":"SymbolTableNode","cross_ref":"paddle","kind":"Gdef","module_hidden":true,"module_public":false},"strtobool":{".class":"SymbolTableNode","cross_ref":"distutils.util.strtobool","kind":"Gdef","module_hidden":true,"module_public":false},"weakref":{".class":"SymbolTableNode","cross_ref":"weakref","kind":"Gdef","module_hidden":true,"module_public":false}},"path":"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/paddle/distributed/fleet/utils/tensor_fusion_helper.py"}